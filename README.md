# *Проект SkyMailing - Сервис рассылки на почту*
____
## Описание
### Представленный проект служит для организации запланированных рассылок персональным клиентам. 

Авторизованный пользователь имеет доступ к:

- Списку личных рассылок и работу с ними:
    - Добавление;
    - Редактирование;
    - Удаление.


- Списку клиентов и работу с ними:
    - Добавление;
    - Редактирование;
    - Удаление.
<br>

>***Клиенты и рассылки связаны с каждым конкретным авторизованным 
пользователем и не могут использоваться другими пользователями.***

- Общему списку писем с возможностью добавления своего письма.


- Общему списку логов.


>***Письма и логи являются общедоступной информацией для других авторизованных пользователей.***

#### *Пользователь считается авторизованным после заполнения формы регистрации и прохождения верификации по почте.*

<br>
Также реализована группа Менеджеров. Для менеджеров имеется дополнительная вкладка со списком пользователей.

### Права менеджера:

- ✅ Может просматривать любые рассылки.
- ✅ Может просматривать список пользователей сервиса.
- ✅ Может блокировать пользователей сервиса.
- ✅ Может отключать рассылки.
- ❌ Не может добавлять клиентов.
- ❌ Не может редактировать рассылки.
- ❌ Не может управлять списком рассылок.
- ❌ Не может изменять рассылки и сообщения.


#### *❗Неавторизованные пользователи имеют доступ только к Главной странице и странице Блога.❗️*


### Рассылка:

- После создания новой рассылки, если текущее время больше времени начала 
и меньше времени окончания, из справочника выбираются все клиенты, 
которые указаны в настройках рассылки, и запускается отправка сообщения
для всех этих клиентов.


- Если создается рассылка со временем старта в будущем, то отправка должна 
стартует автоматически по наступлению этого времени без дополнительных 
действий со стороны пользователя системы.


- По ходу отправки сообщений собирается статистика по каждому сообщению для 
последующего формирования отчетов.


- Отчеты формируются и отправляются в удобочитаемом формате в таблицу логов.

____

## Алгоритм действий

- Скачайте в домашнюю директорию.


- Создайте виртуальное окружение venv командой:

__*python -m venv venv*__

- Активируйте виртуальное окружение командой:

__*venv\Scripts\activate.bat*__

- Для Windows - установите и запустите в дополнительном окне WSL2. Информация по установке:

https://learn.microsoft.com/en-us/windows/wsl/install

- Установите зависимости командой:

__*pip install -r requirements.txt*__

- Создайте Базу Данных (в данном проекте используется PostgreSQL), перейдите в файл '.env.sample'. Заполните в этом файле
все требуемые поля, создайте в директории проекта файл '.env' и перенесите туда заполненный в '.env.sample' шаблон.


- Запустите Redis через WSL2 командой:

`sudo service redis-server start`

- __Авторизуйтесь и наполните БД необходимыми данными (для user - Клиенты и Рассылки, для admin и manager - Письма).__


- Запустите сервис командой:

*Windows:*
`python manage.py runserver`

*MacOS/Linux:*
`python3 manage.py runserver`

- В дополнительном окне терминала запустите APScheduler командой:

*Windows:*
`python manage.py runapscheduler`

*MacOS/Linux:*
`python3 manage.py runapscheduler`

### Завершение работы

Для остановки работы APScheduler используйте комбинацию клавиш `Ctrl+C` в окне терминала, где запущен планировщик.

Для остановки работы сервиса также используйте `Ctrl+C` в окне терминала, где запущен сервер.

Для остановки работы сервера Redis используйте команду: `sudo service redis-server stop` в окне WSL2.